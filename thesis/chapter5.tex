\chapter{Solution} \label{chap:solution}

\section*{}

This chapter describes how the problem presented in Chapter \ref{chap:problem_statement} was solved by stating the solution implemented and the reasons for the choices taken.  

\section{Devices setup for decentralization support}\label{sec:devices_decentralization}

The first goal of this decentralization was to find a way to take advantage of devices with few computational resources, integrating them in a IoT system. The goal was to make these devices execute scripts of code and communicate with other devices, despite the capability limitations of these devices.

\subsection{Solution overview}

% It uses micropython and external libraries such as uasyncio and micropython-mqtt.

\subsection{Limitations}

\begin{itemize}
    \item Only supports mqtt qos 0 and 1, due to limitation of MQTT library used (the only one that has recent support and more complete)
    \item If a given script is too big, there will be memory problems with ESP8266 -> failsafe not possible
\end{itemize}

\section{Node-RED decentralization of computation}\label{sec:node_red_decentralization}

\subsection{Code generation}

\subsection{MQTT node communication support}

\subsection{Custom nodes}

\subsection{Decentralization of computation}

\subsection{Dynamic state management}

\subsection{Limitations}

\begin{itemize}
    \item Number of nodes that support micropython code generation is small
    \item Duplicate messages when redeploying the totallity of the flow (maybe fixable later)
    \item Nodes do not stop working when the Node-RED instance is stopped
\end{itemize}
